# üë©üèª‚Äçüíª Log Analyzer - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ª–æ–≥–æ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

## üåü –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
üîç 1. –ü–∞—Ä—Å–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ Apache/Nginx
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ (chardet)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ö–µ—à-—Å—É–º–º –∑–∞–ø–∏—Å–µ–π

–ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
```bash
LOG_PATTERN = r'^(?P<ip>\S+)\s+.*?"(?P<method>\w+)\s+(?P<api>\S+).*?(?P<status>\d{3})\s+(?P<bytes>\d+)'
```

üóÑÔ∏è 2. –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ daily_stats –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –ü–∞–∫–µ—Ç–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (execute_batch, COPY)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î:
```bash
CREATE TABLE requests (
    id SERIAL PRIMARY KEY,
    ip_id INTEGER REFERENCES ip_addresses(id),
    datetime TIMESTAMP WITH TIME ZONE NOT NULL,
    request_method VARCHAR(10) NOT NULL,
    status_code INTEGER NOT NULL,
    is_error BOOLEAN DEFAULT FALSE
);
```

üìä 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ì—Ä–∞—Ñ–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –¥–Ω—è–º (matplotlib)
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ (4xx/5xx) —á–µ—Ä–µ–∑ –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ (QTableWidget)

–ü—Ä–∏–º–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞:
```bash
plt.bar(df['day'], df['total_requests'], color='skyblue')
plt.title("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –¥–Ω—è–º")
```

üìÅ 4. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- CSV (—á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å csv)
- Parquet (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
- Excel —Å –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (openpyxl)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –¥–∞—Ç–æ–π

–ü—Ä–∏–º–µ—Ä —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel:
```bash
ws.column_dimensions[column].width = adjusted_width
wb.save("ip_stats_2023-11-15.xlsx")
```

‚ö° 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (ThreadPoolExecutor)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤
- –ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î (–¥–æ 500K –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑)
- –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ WAL –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –≤—Å—Ç–∞–≤–æ–∫

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –≤—Å—Ç–∞–≤–∫–∏:
```bash
cursor.execute("SET synchronous_commit TO OFF")
cursor.execute("ALTER TABLE requests SET UNLOGGED")
```

üñ•Ô∏è 6. GUI –Ω–∞ PySide6
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ë–î
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –≤ —Ñ–∞–π–ª app.log

–ü—Ä–∏–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
```bash
self.btn_export_csv = QPushButton("–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV")
self.btn_export_csv.clicked.connect(self.export_data)
```

üîÑ 7. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ —á–∞—Å—Ç—è–º
- –ü—Ä–æ–ø—É—Å–∫ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (—Ö–µ—à-–ø—Ä–æ–≤–µ—Ä–∫–∞)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ë–î –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º –∏–º–ø–æ—Ä—Ç–æ–º

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```bash
CONFIG = {
    'max_batch_rows': 5_000_000,
    'max_workers': os.cpu_count() * 2
}
```

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è           | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏                           |
|---------------------|--------------------------------------|
| **GUI**             | PySide6 (Qt –¥–ª—è Python)              |
| **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**     | psycopg2 (PostgreSQL), execute_batch |
| **–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**   | pandas, openpyxl                     |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**    | matplotlib                           |
| **–ü–∞—Ä—Å–∏–Ω–≥**         | re (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è), chardet   |
| **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** | concurrent.futures (ThreadPool)      |

‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
1. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:
```bash
with ThreadPoolExecutor(max_workers=CONFIG['max_workers']) as executor:
    futures = {executor.submit(process_file, fp): fp for fp in files}
```
2. –®–∞–±–ª–æ–Ω Producer-Consumer:
- –ü–∞—Ä—Å–µ—Ä (producer) ‚Üí –û—á–µ—Ä–µ–¥—å ‚Üí –í—Å—Ç–∞–≤–∫–∞ –≤ –ë–î (consumer)
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Å—Ç–∞–≤–æ–∫:
- COPY FROM –≤–º–µ—Å—Ç–æ INSERT
- –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–¥–æ 5M —Å—Ç—Ä–æ–∫)

üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ (matplotlib)
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (QTableWidget)
- –≠–∫—Å–ø–æ—Ä—Ç –≤ 3 —Ñ–æ—Ä–º–∞—Ç–∞:
```mermaid
graph LR
  A[–î–∞–Ω–Ω—ã–µ] --> B(CSV)
  A --> C(Parquet)
  A --> D(Excel)
```

üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–æ—Ç–∫–∞:
1. –î–æ ~50K —Å—Ç—Ä–æ–∫/—Å–µ–∫ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º CPU
2. –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∫ PostgreSQL
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
–û—Ç–∫–ª—é—á–∞–µ–º WAL –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–µ
```bash
cursor.execute("ALTER TABLE requests SET UNLOGGED")
```

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install -r requirements.txt
```
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PostgreSQL:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Ç—Å–∞–ª–ª—è—Ç–æ—Ä–∞ —Å –æ—Ñ. —Å–∞–π—Ç–∞
- –£–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (postgres)
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ psql -U postgres —Å –≤–≤–æ–¥–æ–º –ø–∞—Ä–æ–ª—è(123) —á–µ—Ä–µ–∑ cmd
- –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ —Ç–∞–±–ª–∏—Ü
```shell
-- –°–æ–∑–¥–∞—Ç—å –ë–î
CREATE DATABASE server_logs;
-- –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–µ–π
\c server_logs
-- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É (–ø—Ä–∏–º–µ—Ä)
CREATE TABLE IF NOT EXISTS log_hashes (
    hash VARCHAR(64) PRIMARY KEY,
    processed_at TIMESTAMP DEFAULT NOW()
)
```
3. –ó–∞–ø—É—Å–∫ app.py –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ:
```bash
py app.py
```
## üéØ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                 | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
|---------------------------|-----------------|
| 1 –ª–æ–≥                     | ~2.5-3 –º–∏–Ω—É—Ç—ã   |
| –ü–∞–ø–∫–∞ –∏–∑ 20 –ª–æ–≥–æ–≤         | ~60 –º–∏–Ω—É—Ç       |
| –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV –∏ Parquet   | ~10 —Å–µ–∫—É–Ω–¥      |
| –≠–∫—Å–ø–æ—Ä—Ç IP –ø–æ –¥–Ω—è–º(Excel) | ~7 —Å–µ–∫—É–Ω–¥       |

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT.

---

<div align="center">
  <p>–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è Hackathon MIPT 2025</p>
  <p>¬© 2025 –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –î–µ—Ç–∏-GPT</p>
</div>

